<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Linear regression with covariance (correlation) matrices • psychmeta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Linear regression with covariance (correlation) matrices">
<meta property="og:description" content="psychmeta">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">psychmeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/artifact_corrections.html">Correcting for artifacts in meta-analyses</a>
    </li>
    <li>
      <a href="../articles/composites.html">Computing composite effect sizes and artifacts</a>
    </li>
    <li>
      <a href="../articles/dependency.html">Handling effect size dependency</a>
    </li>
    <li>
      <a href="../articles/es_conversion.html">Converting effect sizes and applying sporadic artifact corrections</a>
    </li>
    <li>
      <a href="../articles/heterogeneity.html">Heterogeneity analyses</a>
    </li>
    <li>
      <a href="../articles/import_organize.html">Importing and organizing meta-analytic data</a>
    </li>
    <li>
      <a href="../articles/ma_d.html">Meta-analyzing d values</a>
    </li>
    <li>
      <a href="../articles/ma_options.html">Meta-analysis function arguments and options</a>
    </li>
    <li>
      <a href="../articles/ma_r.html">Meta-analyzing correlations</a>
    </li>
    <li>
      <a href="../articles/matrix_regression.html">Linear regression with covariance (correlation) matrices</a>
    </li>
    <li>
      <a href="../articles/moderator_analysis.html">Moderator analyses and meta-regression</a>
    </li>
    <li>
      <a href="../articles/multivariate_range_restriction.html">Multivariate range-restriction correction</a>
    </li>
    <li>
      <a href="../articles/output_results.html">Outputing meta-analysis results to Markdown, Word, or other formats</a>
    </li>
    <li>
      <a href="../articles/overview.html">psychmeta Overview</a>
    </li>
    <li>
      <a href="../articles/plots.html">Plotting meta-analysis results</a>
    </li>
    <li>
      <a href="../articles/sensitivity.html">Sensitivity analyses</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulating psychometric data and meta-analyses</a>
    </li>
    <li>
      <a href="../articles/workshop.html">Welcome to psychmeta!</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/psychmeta/psychmeta/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="matrix_regression_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Linear regression with covariance (correlation) matrices</h1>
            
            <h4 class="date">2021-05-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/psychmeta/psychmeta/blob/master/vignettes/matrix_regression.Rmd"><code>vignettes/matrix_regression.Rmd</code></a></small>
      <div class="hidden name"><code>matrix_regression.Rmd</code></div>

    </div>

    
    
<p><strong>Note: This vignette is a work in progress.</strong></p>
<p>This vignette shows how to conduct multiple regression analyses in <strong>psychmeta</strong> using correlation or covariances as input. For more vignettes, see the <a href="overview.html"><strong>psychmeta</strong> overview</a>.</p>
<div id="matrix-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#matrix-regression" class="anchor"></a>Matrix regression</h2>
<p>It is possible to estiamte OLS regression models using just the correlation matrix (or covariance matrix and means) among variables. This is commonly done when estimating regression models using the results of meta-analyses. <strong>psychmeta</strong> provides a function, <code><a href="../reference/lm_mat.html">lm_mat()</a></code>, to conduct regression analyses using a correlation/covariance matrix that integrates well with the base R regession function: <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function from the <strong><code>stats</code></strong> package. Results from the <code><a href="../reference/lm_mat.html">lm_mat()</a></code> function will look and behave just like results from <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, and you can use them with all sorts of regression helper functions, such as <code><a href="../reference/summary.html">summary()</a></code>, <code><a href="../reference/predict.html">predict()</a></code>, and <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>.</p>
</div>
<div id="regression-with-a-correlation-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-with-a-correlation-matrix" class="anchor"></a>Regression with a correlation matrix</h2>
<p>Let’s analyze this correlation matrix. It includes correlations among the Big Five personality traits (Agreeableness [AG], Emotional Stability [ES], Conscientiousness [CO], Extraversion [EX], Openness [OP]), two additional personality variables (proactive personality [PP], self-efficacy [SE]), and career satisfaction (Csat).</p>
<p>Let’s assume that this correlation matrix was estimated in a sample of 250 people.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cor_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="fl">1.00</span>, <span class="fl">0.31</span>, <span class="fl">0.41</span>, <span class="fl">0.20</span>, <span class="fl">0.19</span>, <span class="fl">0.07</span>, <span class="fl">0.11</span>, <span class="fl">0.15</span>,
    <span class="fl">0.31</span>, <span class="fl">1.00</span>, <span class="fl">0.33</span>, <span class="fl">0.27</span>, <span class="fl">0.09</span>, <span class="fl">0.12</span>, <span class="fl">0.35</span>, <span class="fl">0.34</span>,
    <span class="fl">0.41</span>, <span class="fl">0.33</span>, <span class="fl">1.00</span>, <span class="fl">0.19</span>, <span class="fl">0.12</span>, <span class="fl">0.34</span>, <span class="fl">0.22</span>, <span class="fl">0.16</span>,
    <span class="fl">0.20</span>, <span class="fl">0.27</span>, <span class="fl">0.19</span>, <span class="fl">1.00</span>, <span class="fl">0.33</span>, <span class="fl">0.41</span>, <span class="fl">0.33</span>, <span class="fl">0.24</span>,
    <span class="fl">0.19</span>, <span class="fl">0.09</span>, <span class="fl">0.12</span>, <span class="fl">0.33</span>, <span class="fl">1.00</span>, <span class="fl">0.34</span>, <span class="fl">0.20</span>, <span class="fl">0.17</span>,
    <span class="fl">0.07</span>, <span class="fl">0.12</span>, <span class="fl">0.34</span>, <span class="fl">0.41</span>, <span class="fl">0.34</span>, <span class="fl">1.00</span>, <span class="fl">0.56</span>, <span class="fl">0.31</span>,
    <span class="fl">0.11</span>, <span class="fl">0.35</span>, <span class="fl">0.22</span>, <span class="fl">0.33</span>, <span class="fl">0.20</span>, <span class="fl">0.56</span>, <span class="fl">1.00</span>, <span class="fl">0.53</span>,
    <span class="fl">0.15</span>, <span class="fl">0.34</span>, <span class="fl">0.16</span>, <span class="fl">0.24</span>, <span class="fl">0.17</span>, <span class="fl">0.31</span>, <span class="fl">0.53</span>, <span class="fl">1.00</span>
    <span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">8</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, 
  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AG"</span>, <span class="st">"ES"</span>, <span class="st">"CO"</span>, <span class="st">"EX"</span>, <span class="st">"OP"</span>, <span class="st">"PP"</span>, <span class="st">"SE"</span>, <span class="st">"Csat"</span><span class="op">)</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AG"</span>, <span class="st">"ES"</span>, <span class="st">"CO"</span>, <span class="st">"EX"</span>, <span class="st">"OP"</span>, <span class="st">"PP"</span>, <span class="st">"SE"</span>, <span class="st">"Csat"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">250</span></code></pre></div>
<p>You specify models in <code><a href="../reference/lm_mat.html">lm_mat()</a></code> using the same formula syntax as in <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<p>For example, to estimate a model using the Big Five traits to predict career satisfaction, run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lm_mat.html">lm_mat</a></span><span class="op">(</span><span class="va">Csat</span> <span class="op">~</span> <span class="va">AG</span> <span class="op">+</span> <span class="va">ES</span> <span class="op">+</span> <span class="va">CO</span> <span class="op">+</span> <span class="va">EX</span> <span class="op">+</span> <span class="va">OP</span>,
                 cov_mat <span class="op">=</span> <span class="va">cor_mat</span>,
                 n <span class="op">=</span> <span class="va">N</span>,
                 se_beta_method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Here, the first argument is the model prediction formula. For details on formula specification in R, see <code>help("stats::lm")</code>.</li>
<li>
<code>cov_mat</code> is your covariance or correlation matrix you will use to estimate the model. It must have row and column names corresponding to the variables in the formula.</li>
<li>
<code>n</code> is the sample size.</li>
<li>
<code>se_beta_method</code>. This argument controls how standard errors and confidence intervals are calculated for standardized regression coefficients (beta or ; including all coefficients for models estimated using a correlation [not covariance] matrix).
<ul>
<li>The default, <code>"lm"</code>, will compute standard errors using the same method as <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, based on <span class="citation">Cohen et al. (2003)</span>. This method ignores uncertainty in the standard deviations used to standardize the coefficients and correlations. As a result, confidence intervals will be too narrow.</li>
<li>More accurate standard errors and confidence intervals for standardized coefficients can be obtained by settings <code>se_beta_method = "normal"</code>, which will use the normal-theory approach from <span class="citation">Jones &amp; Waller (2013)</span>.</li>
</ul>
</li>
</ul>
<p>Note that <code><a href="../reference/lm_mat.html">lm_mat()</a></code> is limited to linear models. It can only compute moderated or polynomial regression models if the product or polynomial terms are already in <code>cov_mat</code>. It cannot fit generalized linear models with non-identity link functions (as in <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code>).</p>
<div id="working-with-lm_mat-output" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-lm_mat-output" class="anchor"></a>Working with <code>lm_mat()</code> output</h3>
<p>You can use the same functions to work with <code><a href="../reference/lm_mat.html">lm_mat()</a></code> results as you can with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> results. For example, to view a regression output table:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_b5</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm_mat(formula = Csat ~ AG + ES + CO + EX + OP, cov_mat = cor_mat, 
##     n = N, se_beta_method = "normal")
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4652 -0.6285  0.0000  0.6285  3.4652 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.000000   0.058929   0.000   1.0000    
## AG          0.006374   0.066941   0.095   0.9242    
## ES          0.286736   0.065278   4.393 1.67e-05 ***
## CO          0.027436   0.066774   0.411   0.6815    
## EX          0.123438   0.065026   1.898   0.0588 .  
## OP          0.098956   0.063176   1.566   0.1186    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.9317 on 244 degrees of freedom
## Multiple R-squared:  0.1493, Adjusted R-squared:  0.1319 
## F-statistic: 8.563 on 5 and 244 DF,  p-value: 1.726e-07</code></pre>
<pre><code>## Note: cov_mat is a standardized matrix, interpret coefficients' significance tests with caution. 
## For best results, use an unstandardized covariance matrix as the cov_mat argument.</code></pre>
<p>To predict outcome values for new data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_b5</span>, 
        newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>AG <span class="op">=</span> <span class="fl">1</span>, ES <span class="op">=</span> <span class="fl">1</span>, CO <span class="op">=</span> <span class="fl">1</span>, EX <span class="op">=</span> <span class="fl">0</span>, OP <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.3205457</code></pre>
<p>To extract the model coefficients:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_b5</span><span class="op">)</span></code></pre></div>
<pre><code>## (Intercept)          AG          ES          CO          EX          OP 
## 0.000000000 0.006373903 0.286735885 0.027435886 0.123438304 0.098955782</code></pre>
<p>To compute confidence intervals for the model coefficients:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/confint.html">confint</a></span><span class="op">(</span><span class="va">mod_b5</span><span class="op">)</span></code></pre></div>
<pre><code>##                    2.5 %    97.5 %
## (Intercept) -0.116064605 0.1160646
## AG          -0.125470550 0.1382184
## ES           0.158165052 0.4153067
## CO          -0.104081428 0.1589532
## EX          -0.004634683 0.2515113
## OP          -0.025474375 0.2233859</code></pre>
</div>
<div id="hierarchical-regression-and-model-comparison" class="section level3">
<h3 class="hasAnchor">
<a href="#hierarchical-regression-and-model-comparison" class="anchor"></a>Hierarchical regression and model comparison</h3>
<p>To compare models, use the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function.</p>
<p>For example, let’s say that we want to examine the incremental validity of self-efficacy for predicting career satisfaction. Does knowing someone’s self- efficacy score enable us to predict their career satisfaction better than if we only knew their Big Five trait scores?</p>
<p>To answer this question, fit a regression model including both the Big Five traits and self-efficacy as predictors:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_b5_plus_se</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/lm_mat.html">lm_mat</a></span><span class="op">(</span><span class="va">Csat</span> <span class="op">~</span> <span class="va">AG</span> <span class="op">+</span> <span class="va">ES</span> <span class="op">+</span> <span class="va">CO</span> <span class="op">+</span> <span class="va">EX</span> <span class="op">+</span> <span class="va">OP</span> <span class="op">+</span> <span class="va">SE</span>,
         cov_mat <span class="op">=</span> <span class="va">cor_mat</span>,
         n <span class="op">=</span> <span class="va">N</span>,
         se_beta_method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></code></pre></div>
<p>Then compare the two models using <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_b5</span>, <span class="va">mod_b5_plus_se</span><span class="op">)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Csat ~ AG + ES + CO + EX + OP
## Model 2: Csat ~ AG + ES + CO + EX + OP + SE
## 
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    244 211.83  0     0.000                     
## 2    243 170.80  1    41.029 58.372 4.991e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div id="regression-with-a-covariance-matrix-andor-variable-means" class="section level2">
<h2 class="hasAnchor">
<a href="#regression-with-a-covariance-matrix-andor-variable-means" class="anchor"></a>Regression with a covariance matrix and/or variable means</h2>
<p>You can similarly estimate linear regression models using a covariance matrix and (optionally) a vector of variable means:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sd_vec</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>AG <span class="op">=</span> <span class="fl">2</span>, ES <span class="op">=</span> <span class="fl">3</span>, CO <span class="op">=</span> <span class="fl">2</span>, EX <span class="op">=</span> <span class="fl">1</span>, OP <span class="op">=</span> <span class="fl">2</span>, PP <span class="op">=</span> <span class="fl">4</span>, SE <span class="op">=</span> <span class="fl">5</span>, Csat <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">mean_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>AG <span class="op">=</span> <span class="fl">10</span>, ES <span class="op">=</span> <span class="fl">11</span>, CO <span class="op">=</span> <span class="fl">9</span>, EX <span class="op">=</span> <span class="fl">10</span>, OP <span class="op">=</span> <span class="fl">6</span>, PP <span class="op">=</span> <span class="fl">20</span>, SE <span class="op">=</span> <span class="fl">15</span>, Csat <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">cov_mat</span> <span class="op">&lt;-</span> <span class="va">cor_mat</span> <span class="op">*</span> <span class="op">(</span><span class="va">sd_vec</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">sd_vec</span><span class="op">)</span><span class="op">)</span>

<span class="va">mod_b5_unstd</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/lm_mat.html">lm_mat</a></span><span class="op">(</span><span class="va">Csat</span> <span class="op">~</span> <span class="va">AG</span> <span class="op">+</span> <span class="va">ES</span> <span class="op">+</span> <span class="va">CO</span> <span class="op">+</span> <span class="va">EX</span> <span class="op">+</span> <span class="va">OP</span>,
         cov_mat <span class="op">=</span> <span class="va">cov_mat</span>, 
         mean_vec <span class="op">=</span> <span class="va">mean_vec</span>,
         n <span class="op">=</span> <span class="va">N</span>,
         se_beta_method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></code></pre></div>
<p>Here, <code>cov_mat</code> is your covariance matrix, <code>mean_vec</code> is the vector of variable means, and other arguments are defined as above.</p>
<p>You can view unstandardized regression results using <code><a href="../reference/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_b5_unstd</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm_mat(formula = Csat ~ AG + ES + CO + EX + OP, cov_mat = cov_mat, 
##     mean_vec = mean_vec, n = N, se_beta_method = "normal")
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -103.95  -18.85    0.00   18.85  103.95 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -32.13839   18.87157  -1.703   0.0898 .  
## AG            0.09561    1.00411   0.095   0.9242    
## ES            2.86736    0.65278   4.393 1.67e-05 ***
## CO            0.41154    1.00162   0.411   0.6815    
## EX            3.70315    1.95077   1.898   0.0588 .  
## OP            1.48434    0.94764   1.566   0.1186    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 27.95 on 244 degrees of freedom
## Multiple R-squared:  0.1493, Adjusted R-squared:  0.1319 
## F-statistic: 8.563 on 5 and 244 DF,  p-value: 1.726e-07</code></pre>
<p>To view standardized results for a model estimated with a covariance matrix, extract the <code>coefficients.std</code> object from the <code><a href="../reference/summary.html">summary()</a></code> of the model:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_b5_unstd</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients.std</span></code></pre></div>
<pre><code>##                Estimate Std. Error     t value     Pr(&gt;|t|)
## (Intercept) 0.000000000 0.05892874 -1.70300596 8.984032e-02
## AG          0.006373903 0.06613148  0.09521738 9.242203e-01
## ES          0.286735885 0.06237233  4.39250492 1.671224e-05
## CO          0.027435886 0.06595169  0.41087406 6.815255e-01
## EX          0.123438304 0.06387955  1.89830099 5.883649e-02
## OP          0.098955782 0.06218382  1.56634777 1.185632e-01</code></pre>
</div>
<div id="meta-analytic-regresssion-models" class="section level2">
<h2 class="hasAnchor">
<a href="#meta-analytic-regresssion-models" class="anchor"></a>Meta-analytic regresssion models</h2>
<!-- When an `se_var` argument is implemented, discuss that here, too. -->
<p>You can use <code><a href="../reference/lm_mat.html">lm_mat()</a></code> to conduct regression analsyes with correlation matrices constructed from meta-analytic results. To extract correlation matrices for such analyses from the results of <code>psychmeta</code> meta-analsysis objects, use the <code><a href="../reference/get_stuff.html">get_matrix()</a></code> function:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ma_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ma_r.html">ma_r</a></span><span class="op">(</span>rxyi <span class="op">=</span> <span class="va">rxyi</span>, n <span class="op">=</span> <span class="va">n</span>, 
               rxx <span class="op">=</span> <span class="va">rxxi</span>, ryy <span class="op">=</span> <span class="va">ryyi</span>, 
               ma_method <span class="op">=</span> <span class="st">"ic"</span>, 
               construct_x <span class="op">=</span> <span class="va">x_name</span>,
               construct_y <span class="op">=</span> <span class="va">y_name</span>,
               data <span class="op">=</span> <span class="va">data_r_meas_multi</span><span class="op">)</span></code></pre></div>
<pre><code>##  **** Running ma_r: Meta-analysis of correlations ****</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meta_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_stuff.html">get_matrix</a></span><span class="op">(</span>ma_obj <span class="op">=</span> <span class="va">ma_obj</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/get_stuff.html">get_matrix()</a></code> return a tibble containing lists of matrices for each meta-analysis parameter, arranged like correlation matrices:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">meta_matrix</span><span class="op">)</span></code></pre></div>
<pre><code>## Tibble of meta-analytic matrices 
## ---------------------------------------- 
## # A tibble: 1 x 2
##   barebones         individual_correction
##   &lt;named list&gt;      &lt;named list&gt;         
## 1 &lt;named list [14]&gt; &lt;named list [3]&gt;</code></pre>
<p>For example, in the <code>individual_correction</code> results, you can see matrices for <em>k</em>, <em>N</em>, <em>mean_r</em>, <em>sd_res</em>, <em>mean_rho</em>, <em>sd_rho</em>, etc.:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/print.html">print</a></span><span class="op">(</span><span class="va">meta_matrix</span><span class="op">$</span><span class="va">individual_correction</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">true_score</span><span class="op">)</span></code></pre></div>
<pre><code>## $k
##    X  Y  Z
## X NA 40 40
## Y 40 NA 40
## Z 40 40 NA
## 
## $N
##       X     Y     Z
## X    NA 11927 11927
## Y 11927    NA 11927
## Z 11927 11927    NA
## 
## $mean_r
##           X         Y         Z
## X 1.0000000 0.3166643 0.3235671
## Y 0.3166643 1.0000000 0.3113684
## Z 0.3235671 0.3113684 1.0000000
## 
## $var_r
##            X          Y          Z
## X         NA 0.01560702 0.01660134
## Y 0.01560702         NA 0.01875135
## Z 0.01660134 0.01875135         NA
## 
## $var_e
##             X           Y           Z
## X          NA 0.002731165 0.002704401
## Y 0.002731165          NA 0.002751395
## Z 0.002704401 0.002751395          NA
## 
## $var_res
##            X          Y          Z
## X         NA 0.01287585 0.01389694
## Y 0.01287585         NA 0.01599995
## Z 0.01389694 0.01599995         NA
## 
## $sd_r
##           X         Y         Z
## X        NA 0.1249281 0.1288462
## Y 0.1249281        NA 0.1369356
## Z 0.1288462 0.1369356        NA
## 
## $se_r
##            X          Y          Z
## X         NA 0.01975286 0.02037237
## Y 0.01975286         NA 0.02165141
## Z 0.02037237 0.02165141         NA
## 
## $sd_e
##            X          Y          Z
## X         NA 0.05226055 0.05200385
## Y 0.05226055         NA 0.05245374
## Z 0.05200385 0.05245374         NA
## 
## $sd_res
##           X         Y         Z
## X        NA 0.1134718 0.1178853
## Y 0.1134718        NA 0.1264909
## Z 0.1178853 0.1264909        NA
## 
## $mean_rho
##           X         Y         Z
## X 1.0000000 0.3947027 0.4043143
## Y 0.3947027 1.0000000 0.3891127
## Z 0.4043143 0.3891127 1.0000000
## 
## $var_r_c
##            X          Y          Z
## X         NA 0.02585733 0.02547753
## Y 0.02585733         NA 0.02837824
## Z 0.02547753 0.02837824         NA
## 
## $var_e_c
##             X           Y           Z
## X          NA 0.004280290 0.004212932
## Y 0.004280290          NA 0.004275802
## Z 0.004212932 0.004275802          NA
## 
## $var_rho
##            X          Y          Z
## X         NA 0.02157704 0.02126460
## Y 0.02157704         NA 0.02410244
## Z 0.02126460 0.02410244         NA
## 
## $sd_r_c
##           X         Y         Z
## X        NA 0.1608022 0.1596168
## Y 0.1608022        NA 0.1684584
## Z 0.1596168 0.1684584        NA
## 
## $se_r_c
##            X          Y          Z
## X         NA 0.02542505 0.02523764
## Y 0.02542505         NA 0.02663561
## Z 0.02523764 0.02663561         NA
## 
## $sd_e_c
##            X          Y          Z
## X         NA 0.06542392 0.06490710
## Y 0.06542392         NA 0.06538961
## Z 0.06490710 0.06538961         NA
## 
## $sd_rho
##           X         Y         Z
## X        NA 0.1468913 0.1458239
## Y 0.1468913        NA 0.1552496
## Z 0.1458239 0.1552496        NA
## 
## $CI_LL_95
##           X         Y         Z
## X 1.0000000 0.3432757 0.3532664
## Y 0.3432757 1.0000000 0.3352371
## Z 0.3532664 0.3352371 1.0000000
## 
## $CI_UL_95
##           X         Y         Z
## X 1.0000000 0.4461297 0.4553623
## Y 0.4461297 1.0000000 0.4429883
## Z 0.4553623 0.4429883 1.0000000
## 
## $CR_LL_80
##           X         Y         Z
## X 1.0000000 0.2032096 0.2142127
## Y 0.2032096 1.0000000 0.1867233
## Z 0.2142127 0.1867233 1.0000000
## 
## $CR_UL_80
##           X         Y         Z
## X 1.0000000 0.5861958 0.5944159
## Y 0.5861958 1.0000000 0.5915021
## Z 0.5944159 0.5915021 1.0000000</code></pre>
<p>We can get a matrix of meta-analytic mean correlations by extracting the <code>mean_rho</code> object from this list:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">R_meta</span> <span class="op">&lt;-</span> <span class="va">meta_matrix</span><span class="op">$</span><span class="va">individual_correction</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">true_score</span><span class="op">$</span><span class="va">mean_rho</span></code></pre></div>
<p>We can approximate a sample size for regression analyses by taking an average of the sample sizes from the contributing meta-analyses. For example, the harmonic mean <em>N</em> across meta-analyses is often used <span class="citation">(Viswesvaran &amp; Ones, 1995)</span>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">harmonic_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">ix</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">x</span>
  <span class="va">imn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ix</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">imn</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">N_meta</span> <span class="op">&lt;-</span> <span class="va">meta_matrix</span><span class="op">$</span><span class="va">individual_correction</span><span class="op">$</span><span class="va">`1`</span><span class="op">$</span><span class="va">true_score</span><span class="op">$</span><span class="va">N</span>
<span class="va">N_harm</span> <span class="op">&lt;-</span> <span class="fu">harmonic_mean</span><span class="op">(</span><span class="va">N_meta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">N_meta</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Using the meta-analytic matrix and mean sample size, you can then estimate a meta-analytic regression mode:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lm_mat.html">lm_mat</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span>, 
                   cov_mat <span class="op">=</span> <span class="va">R_meta</span>,
                   n <span class="op">=</span> <span class="va">N_harm</span>,
                   se_beta_method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></code></pre></div>
<p><strong>Note! The standard errors, confidence intervals, and p values for regression results based on an average sample size are only approximate. For more accurate results, consider a GLS approach based on <span class="citation">Becker (1992)</span>. Functions for this approach will be added in a future version.</strong></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-BeckerUsingresultsreplicated1992" class="csl-entry">
Becker, B. J. (1992). Using results from replicated studies to estimate linear models. <em>Journal of Educational Statistics</em>, <em>17</em>(4), 341–362. <a href="https://doi.org/10.3102/10769986017004341">https://doi.org/10.3102/10769986017004341</a>
</div>
<div id="ref-Cohen2003AppliedMultiple" class="csl-entry">
Cohen, J., Cohen, P., West, S. G., &amp; Aiken, L. S. (2003). <em>Applied multiple regression/correlation analysis for the behavioral sciences</em> (3rd ed.). Routledge. <a href="https://doi.org/10.4324/9780203774441">https://doi.org/10.4324/9780203774441</a>
</div>
<div id="ref-JonesComputingconfidenceintervals2013" class="csl-entry">
Jones, J. A., &amp; Waller, N. G. (2013). Computing confidence intervals for standardized regression coefficients. <em>Psychological Methods</em>, <em>18</em>(4), 435–453. <a href="https://doi.org/gckfx4">https://doi.org/gckfx4</a>
</div>
<div id="ref-ViswesvaranTheoryTesting1995" class="csl-entry">
Viswesvaran, C., &amp; Ones, D. S. (1995). Theory testing: combining psychometric meta-analysis and structural equations modeling. <em>Personnel Psychology</em>, <em>48</em>(4), 865–885. <a href="https://doi.org/10.1111/j.1744-6570.1995.tb01784.x">https://doi.org/10.1111/j.1744-6570.1995.tb01784.x</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jeffrey A. Dahlke, Brenton M. Wiernik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
